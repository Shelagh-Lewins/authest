(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,a){e.exports=a(248)},116:function(e,t,a){},246:function(e,t,a){},248:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(29),s=a.n(o),l=(a(116),a(6)),i=a(7),c=a(10),u=a(8),m=a(9),p=a(255),d=a(254),h=a(13),f=a(20),E=a(105),v={},b=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},g=a(122),y={isAuthenticated:!1,forgotPasswordEmailSent:!1,resetPasswordComplete:!1,user:{}},O=Object(f.c)({errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return console.log("error reducer ",t.payload),t.payload;default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return g({isAuthenticated:!b(t.payload.token),user:g.constant({token:t.payload.token})},e);case"SET_USER_INFO":return g({user:{username:t.payload.username,email:t.payload.email,slug:t.payload.slug}},e);case"LOGOUT_USER_COMPLETE":return g({isAuthenticated:!1,user:g.constant({})},e);case"FORGOT_PASSWORD_EMAIL_NOT_SENT":return g({forgotPasswordEmailSent:!1,resetPasswordComplete:!1},e);case"FORGOT_PASSWORD_EMAIL_SENT":return g({forgotPasswordEmailSent:!0,resetPasswordComplete:!1},e);case"RESET_PASSWORD_COMPLETE":return g({forgotPasswordEmailSent:!1,resetPasswordComplete:!0},e);default:return e}}});var w=Object(f.e)(O,{},Object(f.d)(Object(f.a)(E.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),j=function(e){return e||"undefined"},S=function(e){return{type:"SET_CURRENT_USER",payload:e}},k=function(e){return function(t){return fetch("/api/v1/rest-auth/logout/",{method:"POST"}).then(function(a){if(a.ok)return a.json();localStorage.removeItem("jwtToken"),j(!1),e.push("/"),t({type:"GET_ERRORS",payload:{"logout user":"Unable to logout"}})}).then(function(){return t({type:"LOGOUT_USER_COMPLETE"})})}},N=function(e){var t=e.token;return function(e,a){var n={Authorization:"Token ".concat(t),Accept:"application/json","Content-Type":"application/json"};return fetch("/api/v1/rest-auth/user/",{headers:n,method:"GET"}).then(function(t){if(t.ok)return t.json();e({type:"GET_ERRORS",payload:{"get user info":"Unable to get user info"}})}).then(function(t){if(t)return console.log("user ",t),e(function(e){return{type:"SET_USER_INFO",payload:e}}({username:t.username,email:t.email,slug:t.slug}))})}},C=a(249),T=a(257),_=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showDropdown:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"showDropdown",value:function(e){e.preventDefault(),this.setState(function(e){return{showDropdown:!e.showDropdown}})}},{key:"onLogout",value:function(e){e.preventDefault(),this.props.logoutUser(this.props.history)}},{key:"render",value:function(){var e=this,t=this.props.auth,a=t.isAuthenticated,n=t.user;console.log("navbar. state ",this.props.auth);var o=r.a.createElement("ul",{className:"navbar-nav ml-auto"},n.username&&r.a.createElement("li",{className:"nav-item"},r.a.createElement(C.a,{to:"/account",className:"nav-link"},n.username)),r.a.createElement("li",{className:"nav-item"},r.a.createElement(C.a,{to:"/",className:"nav-link",onClick:this.onLogout.bind(this)},"Logout"))),s=r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(C.a,{className:"nav-link",to:"/register"},"Register")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(C.a,{className:"nav-link",to:"/login"},"Login")));return r.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-light bg-light"},r.a.createElement(C.a,{className:"navbar-brand",to:"/"},"My Top Tens"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",onClick:function(t){e.showDropdown(t)}},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse ".concat(this.state.showDropdown?"show":""),id:"navbarSupportedContent"},a?o:s,r.a.createElement("form",{className:"form-inline my-2 my-lg-0"},r.a.createElement("input",{className:"form-control mr-sm-2",type:"search",placeholder:"Search","aria-label":"Search"}),r.a.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"submit"},"Search"))))}}]),t}(n.Component),R=Object(h.b)(function(e){return{auth:e.auth}},{logoutUser:k})(Object(T.a)(_)),M=a(19),D=a(2),P=a(250),I=a(251),A=a(252),L=a(253),x=a(256),U=a(110),F=a(108),G=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={isValidated:!1},e.customMessages={},e.getCustomMessage=function(t){if(t.validity.customError)return t.validationMessage;if(t.validity.typeMismatch)return e.customMessages["".concat(t.type,"Mismatch")];for(var a in e.customMessages)if(t.validity[a])return e.customMessages[a]},e.validate=function(){var t=s.a.findDOMNode(Object(D.a)(Object(D.a)(e))),a=t.length;if(!1===t.checkValidity()){for(var n=0;n<a;n++){var r=t[n],o=r.parentNode.querySelector(".invalid-feedback");if(o&&"button"!==r.nodeName.toLowerCase())if(r.validity.valid)o.textContent="";else{var l=e.getCustomMessage(r)||r.validationMessage;o.textContent=l}}return!1}for(var i=0;i<a;i++){var c=t[i],u=c.parentNode.querySelector(".invalid-feedback");u&&"button"!==c.nodeName.toLowerCase()&&(u.textContent="")}return!0},e.submitHandler=function(t){t.preventDefault(),e.validate()&&e.props.onSubmit(t),e.setState({isValidated:!0})},e.validate=e.validate.bind(Object(D.a)(Object(D.a)(e))),e.checkFieldMatch=e.checkFieldMatch.bind(Object(D.a)(Object(D.a)(e))),e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.inputsmustmatch){var t=s.a.findDOMNode(this),a=this.props.inputsmustmatch.input1,n=this.props.inputsmustmatch.input2,r=t.querySelector("#".concat(a)),o=t.querySelector("#".concat(n));r instanceof HTMLElement&&o instanceof HTMLElement&&(r.oninput=function(t){return e.checkFieldMatch(a,n,t)},o.oninput=function(t){return e.checkFieldMatch(a,n,t)})}}},{key:"checkFieldMatch",value:function(e,t,a){var n=s.a.findDOMNode(this);if(n instanceof HTMLElement){var r=n.querySelector("#".concat(e)),o=n.querySelector("#".concat(t));r instanceof HTMLElement&&o instanceof HTMLElement&&(r.value===o.value?o.setCustomValidity(""):o.setCustomValidity(this.props.inputsmustmatch.message))}}},{key:"render",value:function(){var e=Object(F.a)({},this.props),t=[];return e.className&&(t=Object(U.a)(e.className),delete e.className),this.state.isValidated&&t.push("was-validated"),r.a.createElement("form",Object.assign({},e,{className:t,noValidate:!0,onSubmit:this.submitHandler}),this.props.children)}}]),t}(n.Component),q=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={username:"",email:"",password:"",password_confirm:""},e.handleInputChange=e.handleInputChange.bind(Object(D.a)(Object(D.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(D.a)(Object(D.a)(e))),e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleInputChange",value:function(e){this.setState(Object(M.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={username:this.state.username,email:this.state.email,password1:this.state.password,password2:this.state.password_confirm};this.props.registerUser(t,this.props.history)}},{key:"componentWillReceiveProps",value:function(e){e.auth.isAuthenticated&&this.props.history.push("/"),e.errors&&this.setState({errors:e.errors})}},{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.errors,t=[];return e.registration&&(t=e.registration.map(function(e,t){return r.a.createElement("li",{key:t},e)})),r.a.createElement(P.a,null,r.a.createElement("h2",null,"Create an account"),r.a.createElement(G,{onSubmit:this.handleSubmit,inputsmustmatch:{input1:"password",input2:"password_confirm",message:"Passwords must match"}},r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement(L.a,{for:"email"},"Email address"),r.a.createElement(x.a,{type:"email",name:"email",required:!0,id:"email",onChange:this.handleInputChange,value:this.state.email,placeholder:"Enter your email address"}),r.a.createElement("div",{className:"invalid-feedback"}),r.a.createElement("small",{className:"form-text text-muted"},r.a.createElement("p",null,"You will use your email addres to login. It will not be seen by other users."))))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement(L.a,{for:"username"},"Username"),r.a.createElement(x.a,{type:"text",name:"username",id:"username",required:!0,onChange:this.handleInputChange,value:this.state.username,placeholder:"Enter your username"}),r.a.createElement("div",{className:"invalid-feedback"}),r.a.createElement("small",{className:"form-text text-muted"},r.a.createElement("p",null,"Your username may be seen by other users, for example in comments."))))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement(L.a,{for:"password"},"Password"),r.a.createElement(x.a,{type:"password",name:"password",required:!0,minLength:8,pattern:".*[^0-9].*",id:"password",value:this.state.password,placeholder:"Enter your password",onChange:this.handleInputChange}),r.a.createElement("div",{className:"invalid-feedback"})))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement(L.a,{for:"password_confirm"},"Confirm your password"),r.a.createElement(x.a,{type:"password",name:"password_confirm",id:"password_confirm",required:!0,minLength:8,pattern:".*[^0-9].*",value:this.state.password_confirm,placeholder:"Confirm your password",onChange:this.handleInputChange}),r.a.createElement("div",{className:"invalid-feedback"}),r.a.createElement("small",{className:"form-text text-muted"},r.a.createElement("ul",null,r.a.createElement("li",null,"Your password can't be too similar to your other personal information."),r.a.createElement("li",null,"Your password must contain at least 8 characters."),r.a.createElement("li",null,"Your password can't be a commonly used password."),r.a.createElement("li",null,"Your password can't be entirely numbers.")))))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create account"))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,e.registration&&r.a.createElement("div",{className:"form-feedback ",style:{display:"block"}},r.a.createElement("ul",null,t))))))}}]),t}(n.Component),W=Object(h.b)(function(e){return{auth:e.auth,errors:e.errors}},{registerUser:function(e,t){return function(a){var n=new FormData;for(var r in e)n.append(r,e[r]);fetch("/api/v1/rest-auth/registration/",{method:"POST",body:n}).then(function(e){return e.json().then(function(t){return{data:t,ok:e.ok}}).then(function(e){if(e.ok)t.push("/");else{var n=[];Object.keys(e.data).forEach(function(t){e.data[t].map(function(e){n.push(e)})}),a({type:"GET_ERRORS",payload:{registration:n}})}})})}}})(Object(T.a)(q)),V=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={email:"",password:""},e.handleInputChange=e.handleInputChange.bind(Object(D.a)(Object(D.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(D.a)(Object(D.a)(e))),e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/")}},{key:"componentWillReceiveProps",value:function(e){e.auth.isAuthenticated&&this.props.history.push("/"),e.errors&&this.setState({errors:e.errors})}},{key:"handleInputChange",value:function(e){this.setState(Object(M.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,password:this.state.password};this.props.loginUser(t,this.props.history)}},{key:"render",value:function(){var e=this.props.errors;return r.a.createElement(P.a,null,r.a.createElement("h2",null,"Login"),r.a.createElement(G,{onSubmit:this.handleSubmit},r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement(L.a,{for:"email"},"Email address"),r.a.createElement(x.a,{type:"email",name:"email",id:"email",required:!0,onChange:this.handleInputChange,value:this.state.email,placeholder:"Email address or username"}),r.a.createElement("div",{className:"invalid-feedback"})))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement(L.a,{for:"password"},"Password"),r.a.createElement(x.a,{type:"password",name:"password",required:!0,id:"password",value:this.state.password,placeholder:"Password",onChange:this.handleInputChange}),r.a.createElement("div",{className:"invalid-feedback"})))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Login"))),r.a.createElement(I.a,null,r.a.createElement(A.a,null,e.authentication&&r.a.createElement("div",{className:"form-feedback ",style:{display:"block"}},r.a.createElement("ul",null,e.authentication))))),r.a.createElement(C.a,{className:"nav-link",to:"/forgotpassword"},"Forgot password?"))}}]),t}(n.Component),H=Object(h.b)(function(e){return{auth:e.auth,errors:e.errors}},{loginUser:function(e,t){return function(a){var n=new FormData;for(var r in e)n.append(r,e[r]);return fetch("/api/v1/rest-auth/login/",{method:"POST",body:n}).then(function(e){if(e.ok)return t.push("/"),e.json();a({type:"GET_ERRORS",payload:{authentication:"Unable to log in with the provided credentials, please try again."}})}).then(function(e){if(e)return localStorage.setItem("jwtToken",e.key),j(e.key),a(N({token:e.key})),a(S({token:e.key}))})}}})(V),Y=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"Home Component")}}]),t}(n.Component),X=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={errors:{}},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.auth.isAuthenticated||this.props.history.push("/"),e.errors&&this.setState({errors:e.errors})}},{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated||this.props.history.push("/"),console.log("url params ",this.props.match.params)}},{key:"render",value:function(){this.state.errors;return r.a.createElement("a",{className:"nav-link",href:"/api/v1/password_change"},"Change password")}}]),t}(n.Component),B=Object(h.b)(function(e){return{auth:e.auth,errors:e.errors}})(X),J=a(11),z=a.n(J),$=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={email:"",errors:{}},e.handleInputChange=e.handleInputChange.bind(Object(D.a)(Object(D.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(D.a)(Object(D.a)(e))),e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.auth.isAuthenticated&&this.props.history.push("/"),e.errors&&this.setState({errors:e.errors})}},{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/"),this.props.forgotPasswordEmailNotSent()}},{key:"handleInputChange",value:function(e){this.setState(Object(M.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email};this.props.forgotPassword(t)}},{key:"render",value:function(){var e=this.state.errors;return r.a.createElement("div",{className:"container",style:{marginTop:"50px",width:"700px"}},r.a.createElement("h2",{style:{marginBottom:"40px"}},"Forgot password?"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"email",placeholder:"Email address",className:z()("form-control form-control-lg",{"is-invalid":e.email}),name:"email",onChange:this.handleInputChange,value:this.state.email}),e.email&&r.a.createElement("div",{className:"invalid-feedback"},e.email)),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Send me a password reset email"))),this.props.auth.forgotPasswordEmailSent&&r.a.createElement("div",{className:"feedback"},"An email has been sent to ",this.state.email))}}]),t}(n.Component),K=Object(h.b)(function(e){return{auth:e.auth,errors:e.errors}},{forgotPassword:function(e){return function(t){var a=new FormData;for(var n in e)a.append(n,e[n]);return fetch("/api/v1/rest-auth/password/reset/",{method:"POST",body:a}).then(function(e){return e.json()}).then(function(){return t({type:"FORGOT_PASSWORD_EMAIL_SENT"})}).catch(function(e){console.log("error ",e.message),t({type:"GET_ERRORS",payload:e.response.data})})}},forgotPasswordEmailNotSent:function(e){return{type:"FORGOT_PASSWORD_EMAIL_NOT_SENT"}}})($);a(244),a(246);if(localStorage.jwtToken){j(localStorage.jwtToken),w.dispatch(S(localStorage.jwtToken));var Q=Date.now()/1e3;localStorage.jwtToken.exp<Q&&(w.dispatch(k()),window.location.href="/login")}var Z=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,{store:w},r.a.createElement(p.a,null,r.a.createElement("div",null,r.a.createElement(R,null),r.a.createElement(d.a,{exact:!0,path:"/",component:Y}),r.a.createElement("div",{className:"container"},r.a.createElement(d.a,{exact:!0,path:"/register",component:W}),r.a.createElement(d.a,{exact:!0,path:"/login",component:H}),r.a.createElement(d.a,{exact:!0,path:"/forgotpassword",component:K}),r.a.createElement(d.a,{path:"/account",component:B})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()});s.a.render(r.a.createElement(Z,null),document.getElementById("root"))}},[[111,2,1]]]);
//# sourceMappingURL=main.3a054fbe.chunk.js.map